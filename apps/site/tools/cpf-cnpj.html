<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>CPF/CNPJ Checker — Orbicheck</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <style>
        .container {
            max-width: 42rem;
            margin: 0 auto;
            padding: 0 1rem
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-900 antialiased">
    <main class="container py-12">
        <h1 class="text-3xl font-extrabold">CPF/CNPJ Checker</h1>
        <p class="mt-2 text-gray-700">Local checksum validation for Brazilian tax IDs.</p>
        <form class="bg-white border border-gray-100 rounded-lg p-6 mt-6" onsubmit="return false">
            <label for="id" class="block text-sm font-medium text-gray-700 mb-1">CPF or CNPJ</label>
            <input id="id" class="w-full border border-gray-300 rounded-md px-3 py-2"
                placeholder="123.456.789-09 or 12.345.678/0001-95">
            <button id="go"
                class="mt-4 inline-flex items-center px-4 py-2 rounded-md bg-indigo-600 text-white">Validate</button>
            <div id="out" class="mt-4 text-sm text-gray-800"></div>
            <noscript>
                <div class="mt-4 text-sm text-gray-700">
                    JavaScript disabled. Validate via API:
                    <pre><code>curl -s https://api.orbicheck.com/v1/validate/id \
  -H "Authorization: Bearer YOUR_KEY" \
  -H "Content-Type: application/json" \
  -d '{ "id": "12345678909", "country": "BR", "type": "CPF" }'
</code></pre>
                </div>
            </noscript>
        </form>
    </main>

    <script>
        (function () {
            function onlyDigits(s) { return (s || '').replace(/\D/g, ''); }
            function isRepeated(s) { return /^(\d)\1+$/.test(s); }

            function cpfValid(s) {
                s = onlyDigits(s);
                if (s.length !== 11 || isRepeated(s)) return false;
                var sum = 0;
                for (var i = 0; i < 9; i++) sum += parseInt(s[i]) * (10 - i);
                var d1 = (sum * 10) % 11; if (d1 === 10) d1 = 0;
                if (d1 !== parseInt(s[9])) return false;
                sum = 0;
                for (i = 0; i < 10; i++) sum += parseInt(s[i]) * (11 - i);
                var d2 = (sum * 10) % 11; if (d2 === 10) d2 = 0;
                return d2 === parseInt(s[10]);
            }

            function cnpjValid(s) {
                s = onlyDigits(s);
                if (s.length !== 14 || isRepeated(s)) return false;
                var b1 = [5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2], b2 = [6].concat(b1);
                function calc(base, len) {
                    var sum = 0; for (var i = 0; i < len; i++) sum += parseInt(s[i]) * base[i];
                    var rest = sum % 11; return (rest < 2) ? 0 : 11 - rest;
                }
                var d1 = calc(b1, 12); if (d1 !== parseInt(s[12])) return false;
                var d2 = calc(b2, 13); return d2 === parseInt(s[13]);
            }

            var btn = document.getElementById('go');
            if (!btn) return;
            btn.addEventListener('click', function () {
                var v = document.getElementById('id').value || '';
                var digits = (v || '').replace(/\D/g, '');
                var out = document.getElementById('out');
                if (digits.length <= 11) {
                    var ok = cpfValid(v);
                    out.innerHTML = (ok ? '✅ Valid CPF' : '❌ Invalid CPF') + ' • normalized: <code>' + digits.padStart(11, '0') + '</code>';
                } else {
                    var ok2 = cnpjValid(v);
                    out.innerHTML = (ok2 ? '✅ Valid CNPJ' : '❌ Invalid CNPJ') + ' • normalized: <code>' + digits.padStart(14, '0') + '</code>';
                }
            });
        })();
    </script>
</body>

</html>