openapi: 3.1.0
info:
  title: OrbitCheck API
  description: API for validation, deduplication, and risk assessment services
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: OrbitCheck Team
    email: support@orbitcheck.io
servers:
  - url: https://api.orbitcheck.io/v1
    description: Production server
  - url: https://dev-api.orbitcheck.io/v1
    description: Development server


tags:
  - name: Internal
    description: Internal endpoints for system administration and maintenance.
  - name: Management API
    description: Endpoints for managing your account, data, API keys, and configurations.
  - name: Runtime API
    description: Core operational endpoints for data validation, deduplication, and order processing.
  - name: UI Endpoints
    description: Endpoints used exclusively by the web application UI, such as user authentication and project/plan management.
  - name: Auth
    description: Authentication endpoints.
  - name: Users
    description: User management endpoints.
  - name: Integrations
    description: Third-party integration endpoints for connecting external services.
paths:
  # Authentication paths
  /auth/login:
    post:
      $ref: './paths/auth/login.yml'
  /auth/register:
    post:
      $ref: './paths/auth/register.yml'
  /auth/logout:
    post:
      $ref: './paths/auth/logout.yml'
  /auth/shopify-sso:
    get:
      $ref: './paths/auth/shopify-sso.yml'
  
  # API Keys paths
  /v1/api-keys:
    get:
      $ref: './paths/api-keys/list.yml'
    post:
      $ref: './paths/api-keys/create.yml'
  /v1/api-keys/{id}:
    delete:
      $ref: './paths/api-keys/revoke.yml'
  
  # Webhooks paths
  /v1/webhooks:
    get:
      $ref: './paths/webhooks/list.yml'
    post:
      $ref: './paths/webhooks/create.yml'
  /v1/webhooks/{id}:
    delete:
      $ref: './paths/webhooks/delete.yml'
  /v1/webhooks/test:
    post:
      $ref: './paths/webhooks/test.yml'
  
  # Rules paths
  /v1/rules:
    get:
      $ref: './paths/rules/list.yml'
  /v1/rules/builtin:
    get:
      $ref: './paths/rules/builtin.yml'
  /v1/rules/error-codes:
    get:
      $ref: './paths/rules/error-codes.yml'
  /v1/rules/catalog:
    get:
      $ref: './paths/rules/catalog.yml'
  /v1/rules/test:
    post:
      $ref: './paths/rules/test.yml'
  /v1/rules/register:
    post:
      $ref: './paths/rules/register.yml'
  /v1/rules/{id}:
    delete:
      $ref: './paths/rules/delete.yml'
  
  # Validation paths
  /v1/validate/email:
    post:
      $ref: './paths/validation/email.yml'
  /v1/validate/phone:
    post:
      $ref: './paths/validation/phone.yml'
  /v1/validate/address:
    post:
      $ref: './paths/validation/address.yml'
  /v1/validate/tax-id:
    post:
      $ref: './paths/validation/tax-id.yml'
  /v1/validate/name:
    post:
      $ref: './paths/validation/name.yml'
  
  # Orders and verification
  /v1/orders/evaluate:
    post:
      $ref: './paths/orders/evaluate.yml'
  /v1/verify/phone:
    post:
      $ref: './paths/verification/phone.yml'
  
  # Management API - Logs and Usage
  /v1/data/logs:
    get:
      $ref: './paths/management/logs.yml'
  /v1/data/usage:
    get:
      $ref: './paths/management/usage.yml'
  /v1/logs/{id}:
    delete:
      $ref: './paths/management/log-delete.yml'
  
  # Management API - Personal Access Tokens
  /v1/pats:
    get:
      $ref: './paths/management/pats-list.yml'
    post:
      $ref: './paths/management/pats-create.yml'
  /v1/pats/{token_id}:
    delete:
      $ref: './paths/management/pats-delete.yml'
  
  # Management API - Settings
  /v1/settings:
    get:
      $ref: './paths/management/settings-get.yml'
    put:
      $ref: './paths/management/settings-update.yml'
  
  # Management API - Data operations
  /v1/data/erase:
    post:
      $ref: './paths/management/data-erase.yml'
  
  # Management API - Billing
  /v1/billing/checkout:
    post:
      $ref: './paths/management/billing-checkout.yml'
  /v1/billing/portal:
    post:
      $ref: './paths/management/billing-portal.yml'
  
  # Users management
  /v1/users:
    get:
      $ref: './paths/users/list.yml'
    post:
      $ref: './paths/users/create.yml'
  
  # Normalize paths
  /v1/normalize/address:
    post:
      $ref: './paths/normalize/address.yml'

  # Integrations - Shopify paths
  /integrations/shopify/auth/install:
    get:
      $ref: './paths/integrations/shopify/auth/install.yml'
  /integrations/shopify/auth/callback:
    get:
      $ref: './paths/integrations/shopify/auth/callback.yml'
  /integrations/shopify/api/shop-settings:
    get:
      $ref: './paths/integrations/shopify/api/shop-settings.yml'
    post:
      $ref: './paths/integrations/shopify/api/shop-settings-update.yml'
  /integrations/shopify/api/access-scopes:
    get:
      $ref: './paths/integrations/shopify/api/access-scopes.yml'
  /integrations/shopify/events/app-installed:
    post:
      $ref: './paths/integrations/shopify/events/app-installed.yml'
  /integrations/shopify/events/dashboard-session:
    post:
      $ref: './paths/integrations/shopify/events/dashboard-session.yml'
  /integrations/shopify/webhooks/orders-create:
    post:
      $ref: './paths/integrations/shopify/webhooks/orders-create.yml'
  /integrations/shopify/webhooks/customers-create:
    post:
      $ref: './paths/integrations/shopify/webhooks/customers-create.yml'
  /integrations/shopify/webhooks/customers-update:
    post:
      $ref: './paths/integrations/shopify/webhooks/customers-update.yml'
  /integrations/shopify/address-fix/{token}:
    get:
      $ref: './paths/integrations/shopify/address-fix-get.yml'
    post:
      $ref: './paths/integrations/shopify/address-fix-confirm.yml'
  /integrations/shopify/webhooks/app-uninstalled:
    post:
      $ref: './paths/integrations/shopify/webhooks/app-uninstalled.yml'
  /integrations/shopify/webhooks/gdpr/customers-data-request:
    post:
      $ref: './paths/integrations/shopify/webhooks/gdpr-customers-data-request.yml'
  /integrations/shopify/webhooks/gdpr/customers-redact:
    post:
      $ref: './paths/integrations/shopify/webhooks/gdpr-customers-redact.yml'
  /integrations/shopify/webhooks/gdpr/shop-redact:
    post:
      $ref: './paths/integrations/shopify/webhooks/gdpr-shop-redact.yml'

  # Dedupe paths
  /v1/dedupe/customer:
    post:
      $ref: './paths/dedupe/customer.yml'
  /v1/dedupe/address:
    post:
      $ref: './paths/dedupe/address.yml'
  /v1/dedupe/merge:
    post:
      $ref: './paths/dedupe/merge.yml'
  
  # Batch paths
  /v1/batch/validate:
    post:
      $ref: './paths/batch/validate.yml'
  /v1/batch/dedupe:
    post:
      $ref: './paths/batch/dedupe.yml'
  /v1/batch/orders:
    post:
      $ref: './paths/batch/orders.yml'
  
  # Jobs paths
  /v1/jobs/{id}:
    get:
      $ref: './paths/jobs/get.yml'
  
  # Projects paths
  /projects:
    get:
      $ref: './paths/projects/list.yml'
    post:
      $ref: './paths/projects/create.yml'
  /projects/{id}:
    delete:
      $ref: './paths/projects/delete.yml'
  
  # Plans paths
  /user/plan:
    get:
      $ref: './paths/plans/get.yml'
    patch:
      $ref: './paths/plans/update.yml'
  /public/plans:
    get:
      $ref: './paths/plans/list.yml'
  /public/roi/estimate:
    post:
      $ref: './paths/tools/roi-estimate.yml'
  /user/plan/usage/check:
    post:
      $ref: './paths/plans/usage-check.yml'
components:
  securitySchemes:
      patAuth:
        type: http
        scheme: bearer
        bearerFormat: PAT
        description: Personal Access Token in Authorization ( Bearer <token> ). Use your PAT for management routes.

      apiKeyAuth:
        type: apiKey
        in: header
        name: X-API-Key
        description: Static API key sent in a header. Use your API Key (ok_xxx) for runtime routes.

      cookieAuth:
        type: apiKey
        in: cookie
        name: sid
        description: Session cookie. Used for browser-based authentication.

      csrfHeader:
        type: apiKey
        in: header
        name: X-CSRF-Token
        description: CSRF token obtained from login response. Required for state-changing operations when using cookie authentication.

      httpMessageSigInput:
        type: apiKey
        in: header
        name: Signature-Input
        description: HTTP Message Signatures metadata (RFC 9421). 

      httpMessageSig:
        type: apiKey
        in: header
        name: Signature
        description: HTTP Message Signatures value (RFC 9421).

      shopifySessionToken:
        type: http
        scheme: bearer
        bearerFormat: ShopifySession
        description: Shopify embedded app session JWT sent in the Authorization header.
  schemas:
    Error:
      $ref: './components/schemas/Error.yml'
    ApiKey:
      $ref: './components/schemas/ApiKey.yml'
    Webhook:
      $ref: './components/schemas/Webhook.yml'
    Address:
      $ref: './components/schemas/Address.yml#/components/schemas/Address'
    BaseAddress:
      $ref: './components/schemas/BaseAddress.yml'
    AddressInput:
      $ref: './components/schemas/AddressInput.yml'
    Customer:
      $ref: './components/schemas/Customer.yml'
    CustomerMatch:
      $ref: './components/schemas/CustomerMatch.yml'
    AddressMatch:
      $ref: './components/schemas/AddressMatch.yml'
    DedupeResult:
      $ref: './components/schemas/DedupeResult.yml'
    ValidationResult:
      $ref: './components/schemas/ValidationResult.yml'
    AddressValidationResult:
      $ref: './components/schemas/AddressValidationResult.yml'
    DetailedAddressValidationResult:
      $ref: './components/schemas/DetailedAddressValidationResult.yml'
    LogEntry:
      $ref: './components/schemas/LogEntry.yml'
    Rule:
      $ref: './components/schemas/Rule.yml'
    ReasonCode:
      $ref: './components/schemas/ReasonCode.yml'
    ErrorCode:
      $ref: './components/schemas/ErrorCode.yml'
    CustomRule:
      $ref: './components/schemas/CustomRule.yml'
    UserPlanResponse:
      $ref: './components/schemas/UserPlanResponse.yml'
    UnauthorizedError:
      $ref: './components/schemas/UnauthorizedError.yml'
    ValidationError:
      $ref: './components/schemas/ValidationError.yml'
    NotFoundError:
      $ref: './components/schemas/NotFoundError.yml'
    LimitExceededError:
      $ref: './components/schemas/LimitExceededError.yml'
    ServerError:
      $ref: './components/schemas/ServerError.yml'
    PersonalAccessToken:
      $ref: './components/schemas/PersonalAccessToken.yml'
    RoiEstimateRequest:
      $ref: './components/schemas/RoiEstimateRequest.yml'
    RoiEstimateResponse:
      $ref: './components/schemas/RoiEstimateResponse.yml'
    CreateUserRequest:
      $ref: './components/schemas/CreateUserRequest.yml'
    LoginRequest:
      $ref: './components/schemas/LoginRequest.yml'
    LoginResponse:
      $ref: './components/schemas/LoginResponse.yml'
    User:
      $ref: './components/schemas/User.yml'
    Pagination:
      $ref: './components/schemas/Pagination.yml'
    ShopifyOrder:
      $ref: './components/schemas/ShopifyOrder.yml'
    ShopifyAddress:
      $ref: './components/schemas/ShopifyAddress.yml'
    ShopifyAddressFixSession:
      $ref: './components/schemas/ShopifyAddressFixSession.yml'
    ShopifyAddressFixConfirmRequest:
      $ref: './components/schemas/ShopifyAddressFixConfirmRequest.yml'